modules = ["nodejs-20"]
[nix]
channel = "stable-24_05"

language = "nix"

# Main entrypoint for your application. Replit uses this to understand your project.
entrypoint = "momi_project/backend/index.js"

# Specifies how to install packages.
[packager]
[packager.features]
packageSearch = true

# Environment variables.
[env]
PORT = "3001" # Your backend listens on this port; Replit maps it for web access.

# Command to build your project for deployment.
# This will run before the 'run' command during a deployment.
[build]
# command = "cd momi_project/backend && npm install && npm run build" # Full build
command = "cd momi_project/backend && npm install" # Simplified build: only install backend deps

# Command to run your application (used by both "Run" button and deployments).
[run]
command = "cd momi_project/backend && node index.js"

[[ports]]
localPort = 3001
externalPort = 80

# Deployment configuration.
[deployment]
deploymentTarget = "autoscale"
# buildCommand = "cd momi_project/backend && npm install && npm run build" # Full build
buildCommand = "cd momi_project/backend && npm install" # Simplified build for deployment
runCommand = "cd momi_project/backend && node index.js"
