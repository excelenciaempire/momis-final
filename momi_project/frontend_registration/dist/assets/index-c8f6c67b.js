import{r as w,a as Rr,R as nt,u as ft,L as Bt,B as Pr,b as _r,c as xe,N as Me}from"./react-vendor-c83db486.js";import{c as Cr}from"./supabase-b39f2cee.js";import{u as Ut}from"./form-vendor-ad0166cb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();var $t={exports:{}},qe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ar=w,Mr=Symbol.for("react.element"),Tr=Symbol.for("react.fragment"),kr=Object.prototype.hasOwnProperty,Ir=Ar.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Dr={key:!0,ref:!0,__self:!0,__source:!0};function zt(e,t,r){var n,o={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)kr.call(t,n)&&!Dr.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:Mr,type:e,key:a,ref:i,props:o,_owner:Ir.current}}qe.Fragment=Tr;qe.jsx=zt;qe.jsxs=zt;$t.exports=qe;var s=$t.exports,ot={},vt=Rr;ot.createRoot=vt.createRoot,ot.hydrateRoot=vt.hydrateRoot;let Fr={data:""},Lr=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||Fr,Br=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Ur=/\/\*[^]*?\*\/|  +/g,jt=/\n+/g,de=(e,t)=>{let r="",n="",o="";for(let a in e){let i=e[a];a[0]=="@"?a[1]=="i"?r=a+" "+i+";":n+=a[1]=="f"?de(i,a):a+"{"+de(i,a[1]=="k"?"":t)+"}":typeof i=="object"?n+=de(i,t?t.replace(/([^,])+/g,l=>a.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,m=>/&/.test(m)?m.replace(/&/g,l):l?l+" "+m:m)):a):i!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),o+=de.p?de.p(a,i):a+":"+i+";")}return r+(t&&o?t+"{"+o+"}":o)+n},oe={},qt=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+qt(e[r]);return t}return e},$r=(e,t,r,n,o)=>{let a=qt(e),i=oe[a]||(oe[a]=(m=>{let u=0,c=11;for(;u<m.length;)c=101*c+m.charCodeAt(u++)>>>0;return"go"+c})(a));if(!oe[i]){let m=a!==e?e:(u=>{let c,h,v=[{}];for(;c=Br.exec(u.replace(Ur,""));)c[4]?v.shift():c[3]?(h=c[3].replace(jt," ").trim(),v.unshift(v[0][h]=v[0][h]||{})):v[0][c[1]]=c[2].replace(jt," ").trim();return v[0]})(e);oe[i]=de(o?{["@keyframes "+i]:m}:m,r?"":"."+i)}let l=r&&oe.g?oe.g:null;return r&&(oe.g=oe[i]),((m,u,c,h)=>{h?u.data=u.data.replace(h,m):u.data.indexOf(m)===-1&&(u.data=c?m+u.data:u.data+m)})(oe[i],t,n,l),i},zr=(e,t,r)=>e.reduce((n,o,a)=>{let i=t[a];if(i&&i.call){let l=i(r),m=l&&l.props&&l.props.className||/^go/.test(l)&&l;i=m?"."+m:l&&typeof l=="object"?l.props?"":de(l,""):l===!1?"":l}return n+o+(i??"")},"");function He(e){let t=this||{},r=e.call?e(t.p):e;return $r(r.unshift?r.raw?zr(r,[].slice.call(arguments,1),t.p):r.reduce((n,o)=>Object.assign(n,o&&o.call?o(t.p):o),{}):r,Lr(t.target),t.g,t.o,t.k)}let Ht,it,at;He.bind({g:1});let ie=He.bind({k:1});function qr(e,t,r,n){de.p=t,Ht=e,it=r,at=n}function ue(e,t){let r=this||{};return function(){let n=arguments;function o(a,i){let l=Object.assign({},a),m=l.className||o.className;r.p=Object.assign({theme:it&&it()},l),r.o=/ *go\d+/.test(m),l.className=He.apply(r,n)+(m?" "+m:""),t&&(l.ref=i);let u=e;return e[0]&&(u=l.as||e,delete l.as),at&&u[0]&&at(l),Ht(u,l)}return t?t(o):o}}var Hr=e=>typeof e=="function",Ue=(e,t)=>Hr(e)?e(t):e,Wr=(()=>{let e=0;return()=>(++e).toString()})(),Wt=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),Vr=20,ht="default",Vt=(e,t)=>{let{toastLimit:r}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,r)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:n}=t;return Vt(e,{type:e.toasts.find(i=>i.id===n.id)?1:0,toast:n});case 3:let{toastId:o}=t;return{...e,toasts:e.toasts.map(i=>i.id===o||o===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let a=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},Ie=[],Jt={toasts:[],pausedAt:void 0,settings:{toastLimit:Vr}},se={},Yt=(e,t=ht)=>{se[t]=Vt(se[t]||Jt,e),Ie.forEach(([r,n])=>{r===t&&n(se[t])})},Kt=e=>Object.keys(se).forEach(t=>Yt(e,t)),Jr=e=>Object.keys(se).find(t=>se[t].toasts.some(r=>r.id===e)),We=(e=ht)=>t=>{Yt(t,e)},Yr={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Kr=(e={},t=ht)=>{let[r,n]=w.useState(se[t]||Jt),o=w.useRef(se[t]);w.useEffect(()=>(o.current!==se[t]&&n(se[t]),Ie.push([t,n]),()=>{let i=Ie.findIndex(([l])=>l===t);i>-1&&Ie.splice(i,1)}),[t]);let a=r.toasts.map(i=>{var l,m,u;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((l=e[i.type])==null?void 0:l.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((m=e[i.type])==null?void 0:m.duration)||(e==null?void 0:e.duration)||Yr[i.type],style:{...e.style,...(u=e[i.type])==null?void 0:u.style,...i.style}}});return{...r,toasts:a}},Gr=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||Wr()}),Ee=e=>(t,r)=>{let n=Gr(t,e,r);return We(n.toasterId||Jr(n.id))({type:2,toast:n}),n.id},U=(e,t)=>Ee("blank")(e,t);U.error=Ee("error");U.success=Ee("success");U.loading=Ee("loading");U.custom=Ee("custom");U.dismiss=(e,t)=>{let r={type:3,toastId:e};t?We(t)(r):Kt(r)};U.dismissAll=e=>U.dismiss(void 0,e);U.remove=(e,t)=>{let r={type:4,toastId:e};t?We(t)(r):Kt(r)};U.removeAll=e=>U.remove(void 0,e);U.promise=(e,t,r)=>{let n=U.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(o=>{let a=t.success?Ue(t.success,o):void 0;return a?U.success(a,{id:n,...r,...r==null?void 0:r.success}):U.dismiss(n),o}).catch(o=>{let a=t.error?Ue(t.error,o):void 0;a?U.error(a,{id:n,...r,...r==null?void 0:r.error}):U.dismiss(n)}),e};var Xr=1e3,Zr=(e,t="default")=>{let{toasts:r,pausedAt:n}=Kr(e,t),o=w.useRef(new Map).current,a=w.useCallback((h,v=Xr)=>{if(o.has(h))return;let j=setTimeout(()=>{o.delete(h),i({type:4,toastId:h})},v);o.set(h,j)},[]);w.useEffect(()=>{if(n)return;let h=Date.now(),v=r.map(j=>{if(j.duration===1/0)return;let f=(j.duration||0)+j.pauseDuration-(h-j.createdAt);if(f<0){j.visible&&U.dismiss(j.id);return}return setTimeout(()=>U.dismiss(j.id,t),f)});return()=>{v.forEach(j=>j&&clearTimeout(j))}},[r,n,t]);let i=w.useCallback(We(t),[t]),l=w.useCallback(()=>{i({type:5,time:Date.now()})},[i]),m=w.useCallback((h,v)=>{i({type:1,toast:{id:h,height:v}})},[i]),u=w.useCallback(()=>{n&&i({type:6,time:Date.now()})},[n,i]),c=w.useCallback((h,v)=>{let{reverseOrder:j=!1,gutter:f=8,defaultPosition:b}=v||{},x=r.filter(S=>(S.position||b)===(h.position||b)&&S.height),R=x.findIndex(S=>S.id===h.id),_=x.filter((S,A)=>A<R&&S.visible).length;return x.filter(S=>S.visible).slice(...j?[_+1]:[0,_]).reduce((S,A)=>S+(A.height||0)+f,0)},[r]);return w.useEffect(()=>{r.forEach(h=>{if(h.dismissed)a(h.id,h.removeDelay);else{let v=o.get(h.id);v&&(clearTimeout(v),o.delete(h.id))}})},[r,a]),{toasts:r,handlers:{updateHeight:m,startPause:l,endPause:u,calculateOffset:c}}},Qr=ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,es=ie`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ts=ie`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,rs=ue("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Qr} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${es} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${ts} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ss=ie`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ns=ue("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${ss} 1s linear infinite;
`,os=ie`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,is=ie`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,as=ue("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${os} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${is} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,ls=ue("div")`
  position: absolute;
`,cs=ue("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,ds=ie`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,us=ue("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${ds} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,ms=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?w.createElement(us,null,t):t:r==="blank"?null:w.createElement(cs,null,w.createElement(ns,{...n}),r!=="loading"&&w.createElement(ls,null,r==="error"?w.createElement(rs,{...n}):w.createElement(as,{...n})))},fs=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,hs=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,ps="0%{opacity:0;} 100%{opacity:1;}",gs="0%{opacity:1;} 100%{opacity:0;}",ys=ue("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,xs=ue("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,bs=(e,t)=>{let r=e.includes("top")?1:-1,[n,o]=Wt()?[ps,gs]:[fs(r),hs(r)];return{animation:t?`${ie(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ie(o)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},ws=w.memo(({toast:e,position:t,style:r,children:n})=>{let o=e.height?bs(e.position||t||"top-center",e.visible):{opacity:0},a=w.createElement(ms,{toast:e}),i=w.createElement(xs,{...e.ariaProps},Ue(e.message,e));return w.createElement(ys,{className:e.className,style:{...o,...r,...e.style}},typeof n=="function"?n({icon:a,message:i}):w.createElement(w.Fragment,null,a,i))});qr(w.createElement);var vs=({id:e,className:t,style:r,onHeightUpdate:n,children:o})=>{let a=w.useCallback(i=>{if(i){let l=()=>{let m=i.getBoundingClientRect().height;n(e,m)};l(),new MutationObserver(l).observe(i,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return w.createElement("div",{ref:a,className:t,style:r},o)},js=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},o=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Wt()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...o}},Ns=He`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Te=16,Ss=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:o,toasterId:a,containerStyle:i,containerClassName:l})=>{let{toasts:m,handlers:u}=Zr(r,a);return w.createElement("div",{"data-rht-toaster":a||"",style:{position:"fixed",zIndex:9999,top:Te,left:Te,right:Te,bottom:Te,pointerEvents:"none",...i},className:l,onMouseEnter:u.startPause,onMouseLeave:u.endPause},m.map(c=>{let h=c.position||t,v=u.calculateOffset(c,{reverseOrder:e,gutter:n,defaultPosition:t}),j=js(h,v);return w.createElement(vs,{id:c.id,key:c.id,onHeightUpdate:u.updateHeight,className:c.visible?Ns:"",style:j},c.type==="custom"?Ue(c.message,c):o?o(c):w.createElement(ws,{toast:c,position:h}))}))},g=U;const Es="https://qohvdyqsulzzdtvavpgz.supabase.co",Os="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFvaHZkeXFzdWx6emR0dmF2cGd6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc3NjEzNjMsImV4cCI6MjA2MzMzNzM2M30.TzIjwzHoYoyvROii1tzSrbevlunXIafrM2YVMafsXAU",z=Cr(Es,Os,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce",storage:window.localStorage,storageKey:"momi-auth-token"}}),Rs=async()=>{const{data:{user:e},error:t}=await z.auth.getUser();return t?(console.error("Error getting current user:",t),null):e},Ps=async e=>{const{data:t,error:r}=await z.from("user_profiles").select("*").eq("auth_user_id",e).single();return r?(console.error("Error fetching user profile:",r),null):t},_s=({onSuccess:e})=>{const[t,r]=w.useState(!1),[n,o]=w.useState(!1),[a,i]=w.useState(!1),{register:l,handleSubmit:m,watch:u,formState:{errors:c},setValue:h,getValues:v}=Ut({defaultValues:{firstName:"",lastName:"",email:"",password:"",confirmPassword:"",familyRoles:[],childrenCount:"0",childrenAges:[],mainConcerns:[],mainConcernsOther:"",dietaryPreferences:[],dietaryPreferencesOther:"",personalizedSupport:!1,agreeToTerms:!1}}),j=u("mainConcerns"),f=u("dietaryPreferences");nt.useEffect(()=>{o(j==null?void 0:j.includes("other"))},[j]),nt.useEffect(()=>{i(f==null?void 0:f.includes("other"))},[f]);const b=[{value:"hoping_to_become_mother",label:"Hoping to become a mother one day"},{value:"currently_pregnant",label:"Currently pregnant"},{value:"mom_young_children",label:"Mom of young children (0â€“5)"},{value:"mom_school_age",label:"Mom of school-age children (6â€“12)"},{value:"mom_teens",label:"Mom of teens (13â€“18)"},{value:"wise_woman",label:"Wise Woman (Grandparent, Aunt, etc) helping raise children"}],x=[{value:"0-2",label:"0â€“2 (Infant/Toddler)"},{value:"3-5",label:"3â€“5 (Preschool)"},{value:"6-12",label:"6â€“12 (School-age)"},{value:"13-18",label:"13â€“18 (Teen)"},{value:"18+",label:"18+ (Young Adult)"},{value:"expecting",label:"Expecting a child"}],R=[{value:"food",label:"Food: Nourishment and healing"},{value:"resilience",label:"Resilience: Stress, sleep, nervous system support"},{value:"movement",label:"Movement: Physical activity and energy"},{value:"community",label:"Community: Relationships and support"},{value:"spiritual",label:"Spiritual: Purpose and emotional healing"},{value:"environment",label:"Environment: Detoxifying your home"},{value:"abundance",label:"Abundance: Financial health and resources"},{value:"other",label:"Other"}],_=[{value:"gluten_free",label:"Gluten-free"},{value:"dairy_free",label:"Dairy-free"},{value:"nut_free",label:"Nut-free"},{value:"soy_free",label:"Soy-free"},{value:"vegetarian",label:"Vegetarian"},{value:"vegan",label:"Vegan"},{value:"no_preference",label:"No specific preference"},{value:"other",label:"Other"}],S=(p,O,C)=>{const I=v(p)||[];C?h(p,[...I,O]):h(p,I.filter(F=>F!==O))},A=async p=>{r(!0);try{if(p.password!==p.confirmPassword){g.error("Passwords do not match"),r(!1);return}if(!p.agreeToTerms){g.error("You must agree to the Terms and Conditions"),r(!1);return}if(p.familyRoles.length===0){g.error("Please select at least one family role"),r(!1);return}if(p.mainConcerns.length===0){g.error("Please select at least one main concern or goal"),r(!1);return}const{data:O,error:C}=await z.auth.signUp({email:p.email,password:p.password,options:{data:{first_name:p.firstName,last_name:p.lastName}}});if(C){console.error("Auth error:",C),C.message.includes("already registered")?g.error("This email is already registered. Please try logging in instead."):g.error(C.message||"Failed to create account"),r(!1);return}if(!O.user){g.error("Failed to create user account"),r(!1);return}const I={auth_user_id:O.user.id,email:p.email,first_name:p.firstName,last_name:p.lastName,family_roles:p.familyRoles,children_count:parseInt(p.childrenCount),children_ages:p.childrenAges,main_concerns:p.mainConcerns.filter(F=>F!=="other"),main_concerns_other:p.mainConcernsOther||null,dietary_preferences:p.dietaryPreferences.filter(F=>F!=="other"),dietary_preferences_other:p.dietaryPreferencesOther||null,personalized_support:p.personalizedSupport,registration_metadata:{registration_date:new Date().toISOString(),registration_source:"web_form",form_version:"1.0",raw_form_data:p}};setTimeout(async()=>{try{const{error:F}=await z.from("user_profiles").update({family_roles:p.familyRoles,children_count:parseInt(p.childrenCount),children_ages:p.childrenAges,main_concerns:p.mainConcerns.filter(V=>V!=="other"),main_concerns_other:p.mainConcernsOther||null,dietary_preferences:p.dietaryPreferences.filter(V=>V!=="other"),dietary_preferences_other:p.dietaryPreferencesOther||null,personalized_support:p.personalizedSupport,registration_metadata:{registration_date:new Date().toISOString(),registration_source:"web_form",form_version:"1.0",raw_form_data:p}}).eq("auth_user_id",O.user.id);F&&console.error("Profile update error:",F)}catch(F){console.error("Profile update failed:",F)}},2e3),g.success("Account created successfully! Welcome to MOOMi!"),localStorage.removeItem("pendingConfirmationEmail"),window.location.href="/chat"}catch(O){console.error("Registration error:",O),g.error("An unexpected error occurred. Please try again.")}r(!1)};return s.jsx("div",{className:"registration-form",children:s.jsxs("form",{onSubmit:m(A),className:"space-y-6",children:[s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{className:"section-title",children:"1. Basic Information"}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label required",children:"First Name"}),s.jsx("input",{type:"text",className:`form-input ${c.firstName?"error":""}`,...l("firstName",{required:"First name is required",minLength:{value:2,message:"First name must be at least 2 characters"}}),placeholder:"Enter your first name"}),c.firstName&&s.jsx("span",{className:"form-error",children:c.firstName.message})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label required",children:"Last Name"}),s.jsx("input",{type:"text",className:`form-input ${c.lastName?"error":""}`,...l("lastName",{required:"Last name is required",minLength:{value:2,message:"Last name must be at least 2 characters"}}),placeholder:"Enter your last name"}),c.lastName&&s.jsx("span",{className:"form-error",children:c.lastName.message})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label required",children:"Email Address"}),s.jsx("input",{type:"email",className:`form-input ${c.email?"error":""}`,...l("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Please enter a valid email address"}}),placeholder:"Enter your email address"}),c.email&&s.jsx("span",{className:"form-error",children:c.email.message}),s.jsx("p",{className:"form-help",children:"Must be the same as Circle. If you are not a current MOMS on a Mission member using the same name and email on record, we reserve the right to revoke your access to MOMi."})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label required",children:"Password"}),s.jsx("input",{type:"password",className:`form-input ${c.password?"error":""}`,...l("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),placeholder:"Choose a secure password"}),c.password&&s.jsx("span",{className:"form-error",children:c.password.message})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label required",children:"Confirm Password"}),s.jsx("input",{type:"password",className:`form-input ${c.confirmPassword?"error":""}`,...l("confirmPassword",{required:"Please confirm your password"}),placeholder:"Confirm your password"}),c.confirmPassword&&s.jsx("span",{className:"form-error",children:c.confirmPassword.message})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("h3",{className:"section-title",children:["2. Family Role ",s.jsx("span",{className:"required-indicator",children:"(Check all that apply)"})]}),s.jsx("div",{className:"checkbox-group",children:b.map(p=>s.jsxs("div",{className:"checkbox-item",children:[s.jsx("input",{type:"checkbox",id:`family-role-${p.value}`,className:"checkbox-input",...l("familyRoles"),value:p.value,onChange:O=>S("familyRoles",p.value,O.target.checked)}),s.jsx("label",{htmlFor:`family-role-${p.value}`,className:"checkbox-label",children:p.label})]},p.value))})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{className:"section-title",children:"3. Number of Children"}),s.jsx("div",{className:"form-group",children:s.jsx("select",{className:"form-select",...l("childrenCount"),children:Array.from({length:11},(p,O)=>s.jsx("option",{value:O.toString(),children:O===10?"10+":O},O))})})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("h3",{className:"section-title",children:["4. Ages of Children ",s.jsx("span",{className:"section-subtitle",children:"(Select all that apply)"})]}),s.jsx("div",{className:"checkbox-group",children:x.map(p=>s.jsxs("div",{className:"checkbox-item",children:[s.jsx("input",{type:"checkbox",id:`children-age-${p.value}`,className:"checkbox-input",value:p.value,onChange:O=>S("childrenAges",p.value,O.target.checked)}),s.jsx("label",{htmlFor:`children-age-${p.value}`,className:"checkbox-label",children:p.label})]},p.value))})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("h3",{className:"section-title",children:["5. Main Concerns or Goals ",s.jsx("span",{className:"section-subtitle",children:"(Select multiple or write in)"})]}),s.jsx("div",{className:"checkbox-group",children:R.map(p=>s.jsxs("div",{className:"checkbox-item",children:[s.jsx("input",{type:"checkbox",id:`concern-${p.value}`,className:"checkbox-input",value:p.value,onChange:O=>S("mainConcerns",p.value,O.target.checked)}),s.jsx("label",{htmlFor:`concern-${p.value}`,className:"checkbox-label",children:p.label})]},p.value))}),n&&s.jsxs("div",{className:"form-group mt-4",children:[s.jsx("label",{className:"form-label",children:"Please specify your other concern:"}),s.jsx("input",{type:"text",className:"form-input",...l("mainConcernsOther"),placeholder:"Describe your specific concern or goal"})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("h3",{className:"section-title",children:["6. Dietary Preferences and Allergies ",s.jsx("span",{className:"section-subtitle",children:"(Lifestyle Preferences Only)"})]}),s.jsx("div",{className:"checkbox-group",children:_.map(p=>s.jsxs("div",{className:"checkbox-item",children:[s.jsx("input",{type:"checkbox",id:`dietary-${p.value}`,className:"checkbox-input",value:p.value,onChange:O=>S("dietaryPreferences",p.value,O.target.checked)}),s.jsx("label",{htmlFor:`dietary-${p.value}`,className:"checkbox-label",children:p.label})]},p.value))}),a&&s.jsxs("div",{className:"form-group mt-4",children:[s.jsx("label",{className:"form-label",children:"Please specify your other dietary preference:"}),s.jsx("input",{type:"text",className:"form-input",...l("dietaryPreferencesOther"),placeholder:"Describe your specific dietary preference or allergy"})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsx("h3",{className:"section-title",children:"7. Future Enhancements: Personalized Support"}),s.jsxs("div",{className:"radio-group",children:[s.jsxs("div",{className:"radio-item",children:[s.jsx("input",{type:"radio",id:"personalized-yes",className:"radio-input",...l("personalizedSupport"),value:!0}),s.jsx("label",{htmlFor:"personalized-yes",className:"radio-label",children:"Yes, personalize and include future tailored recommendations (including affiliate offers when relevant)"})]}),s.jsxs("div",{className:"radio-item",children:[s.jsx("input",{type:"radio",id:"personalized-no",className:"radio-input",...l("personalizedSupport"),value:!1}),s.jsx("label",{htmlFor:"personalized-no",className:"radio-label",children:"No, I prefer to see only general content based on my own browsing choices"})]})]})]}),s.jsxs("div",{className:"form-section",children:[s.jsxs("div",{className:"checkbox-item",children:[s.jsx("input",{type:"checkbox",id:"agree-terms",className:"checkbox-input",...l("agreeToTerms",{required:"You must agree to the Terms and Conditions"})}),s.jsxs("label",{htmlFor:"agree-terms",className:"checkbox-label",children:["I agree to the ",s.jsx("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",children:"Terms and Conditions"})]})]}),c.agreeToTerms&&s.jsx("span",{className:"form-error",children:c.agreeToTerms.message})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{type:"submit",disabled:t,className:`btn btn-primary btn-large btn-full ${t?"loading":""}`,children:s.jsxs("span",{className:"btn-content",children:[t&&s.jsx("span",{className:"loading-spinner"}),t?"Creating Account...":"Create My MOMi Account"]})})})]})})},Cs=({onRegistrationSuccess:e})=>s.jsx("div",{className:"registration-page",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"registration-container",children:[s.jsxs("div",{className:"registration-header",children:[s.jsx("img",{src:"/momi-icon-2.png",alt:"MOMi Logo",className:"registration-logo"}),s.jsx("h1",{children:"Join the MOMi Community"}),s.jsx("p",{className:"registration-subtitle",children:"Get personalized wellness support based on the 7 Pillars of Wellness. Create your account to start your journey with MOMi, your AI-powered wellness assistant."})]}),s.jsx("div",{className:"registration-form-container",children:s.jsx(_s,{onSuccess:e})}),s.jsx("div",{className:"registration-login-link",children:s.jsxs("p",{children:["Already have an account?"," ",s.jsx("a",{href:"/login",className:"login-link",children:"Sign in here"})]})}),s.jsxs("div",{className:"registration-trust-indicators",children:[s.jsxs("div",{className:"trust-item",children:[s.jsx("span",{className:"trust-icon",children:"ðŸ”’"}),s.jsx("span",{children:"Your data is secure and private"})]}),s.jsxs("div",{className:"trust-item",children:[s.jsx("span",{className:"trust-icon",children:"ðŸ¤"}),s.jsx("span",{children:"MOMS on a Mission community"})]}),s.jsxs("div",{className:"trust-item",children:[s.jsx("span",{className:"trust-icon",children:"ðŸ’œ"}),s.jsx("span",{children:"Empathetic AI support"})]})]})]})})}),As=({onLoginSuccess:e})=>{const[t,r]=w.useState(!1),[n,o]=w.useState(!1),[a,i]=w.useState(!1),l=ft(),{register:m,handleSubmit:u,formState:{errors:c}}=Ut({defaultValues:{email:"",password:""}}),h=async j=>{r(!0),i(!1);let f=!1;try{const b=z.auth.signInWithPassword({email:j.email,password:j.password}),x=new Promise((C,I)=>setTimeout(()=>I(new Error("Login timeout")),8e3)),{data:R,error:_}=await Promise.race([b,x]);if(_){console.error("Login error:",_),_.message.includes("Invalid login credentials")?g.error("Invalid email or password. Please check your credentials."):_.message.includes("Email not confirmed")?g.error("Please check your email and click the confirmation link before logging in."):g.error(_.message||"Failed to log in");return}if(!(R!=null&&R.user)){g.error("Login failed. Please try again.");return}const S=z.from("user_profiles").select("*").eq("auth_user_id",R.user.id).single(),A=new Promise((C,I)=>setTimeout(()=>I(new Error("Profile fetch timeout")),5e3)),{data:p,error:O}=await Promise.race([S,A]);if(O||!p){if(console.error("Profile fetch error:",O),R.user){g.success("Welcome back! Loading your profile..."),e&&e(R.user,null),f=!0,i(!0),r(!1),l("/chat",{replace:!0});return}g.error("Unable to load user profile. Please try again."),await z.auth.signOut();return}g.success(`Welcome back, ${p.first_name}!`),e&&e(R.user,p),f=!0,i(!0),r(!1),l("/chat",{replace:!0})}catch(b){console.error("Unexpected login error:",b),b.message==="Login timeout"||b.message==="Profile fetch timeout"?g.error("Login is taking longer than expected. Please check your connection and try again."):g.error("An unexpected error occurred. Please try again.")}finally{f||r(!1)}},v=async()=>{const j=document.getElementById("email").value;if(!j){g.error("Please enter your email address first.");return}try{const{error:f}=await z.auth.resetPasswordForEmail(j,{redirectTo:`${window.location.origin}/reset-password`});f?(console.error("Password reset error:",f),g.error("Failed to send password reset email.")):g.success("Password reset email sent! Check your inbox.")}catch(f){console.error("Unexpected password reset error:",f),g.error("An unexpected error occurred.")}};return s.jsx("div",{className:"login-page",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"login-container",children:[s.jsxs("div",{className:"login-header",children:[s.jsx("img",{src:"/momi-icon-2.png",alt:"MOMi Logo",className:"login-logo"}),s.jsx("h1",{children:"Welcome Back to MOMi"}),s.jsx("p",{className:"login-subtitle",children:"Your AI-powered wellness assistant is ready to continue supporting your journey."})]}),s.jsx("div",{className:"login-form-container",children:s.jsxs("form",{onSubmit:u(h),className:"login-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"email",className:"form-label required",children:"Email Address"}),s.jsx("input",{id:"email",type:"email",className:`form-input ${c.email?"error":""}`,...m("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Please enter a valid email address"}}),placeholder:"Enter your email address",autoComplete:"email"}),c.email&&s.jsx("span",{className:"form-error",children:c.email.message})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"password",className:"form-label required",children:"Password"}),s.jsxs("div",{className:"password-input-container",children:[s.jsx("input",{id:"password",type:n?"text":"password",className:`form-input ${c.password?"error":""}`,...m("password",{required:"Password is required"}),placeholder:"Enter your password",autoComplete:"current-password"}),s.jsx("button",{type:"button",className:"password-toggle-btn",onClick:()=>o(!n),"aria-label":n?"Hide password":"Show password",children:n?"ðŸ‘ï¸":"ðŸ‘ï¸â€ðŸ—¨ï¸"})]}),c.password&&s.jsx("span",{className:"form-error",children:c.password.message})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{type:"submit",disabled:t||a,className:`btn btn-primary btn-large btn-full ${t||a?"loading":""}`,children:s.jsxs("span",{className:"btn-content",children:[(t||a)&&s.jsx("span",{className:"loading-spinner"}),a?"Redirecting...":t?"Signing In...":"Sign In to MOMi"]})})}),s.jsx("div",{className:"form-footer",children:s.jsx("button",{type:"button",onClick:v,className:"forgot-password-link",children:"Forgot your password?"})})]})}),s.jsx("div",{className:"login-register-link",children:s.jsxs("p",{children:["Don't have an account?"," ",s.jsx("a",{href:"/register",className:"register-link",children:"Join MOMi today"})]})})]})})})};function Gt(e,t){return function(){return e.apply(t,arguments)}}const{toString:Ms}=Object.prototype,{getPrototypeOf:pt}=Object,{iterator:Ve,toStringTag:Xt}=Symbol,Je=(e=>t=>{const r=Ms.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ee=e=>(e=e.toLowerCase(),t=>Je(t)===e),Ye=e=>t=>typeof t===e,{isArray:we}=Array,be=Ye("undefined");function Oe(e){return e!==null&&!be(e)&&e.constructor!==null&&!be(e.constructor)&&W(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Zt=ee("ArrayBuffer");function Ts(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Zt(e.buffer),t}const ks=Ye("string"),W=Ye("function"),Qt=Ye("number"),Re=e=>e!==null&&typeof e=="object",Is=e=>e===!0||e===!1,De=e=>{if(Je(e)!=="object")return!1;const t=pt(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Xt in e)&&!(Ve in e)},Ds=e=>{if(!Re(e)||Oe(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Fs=ee("Date"),Ls=ee("File"),Bs=ee("Blob"),Us=ee("FileList"),$s=e=>Re(e)&&W(e.pipe),zs=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||W(e.append)&&((t=Je(e))==="formdata"||t==="object"&&W(e.toString)&&e.toString()==="[object FormData]"))},qs=ee("URLSearchParams"),[Hs,Ws,Vs,Js]=["ReadableStream","Request","Response","Headers"].map(ee),Ys=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Pe(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,o;if(typeof e!="object"&&(e=[e]),we(e))for(n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else{if(Oe(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let l;for(n=0;n<i;n++)l=a[n],t.call(null,e[l],l,e)}}function er(e,t){if(Oe(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,o;for(;n-- >0;)if(o=r[n],t===o.toLowerCase())return o;return null}const pe=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),tr=e=>!be(e)&&e!==pe;function lt(){const{caseless:e,skipUndefined:t}=tr(this)&&this||{},r={},n=(o,a)=>{const i=e&&er(r,a)||a;De(r[i])&&De(o)?r[i]=lt(r[i],o):De(o)?r[i]=lt({},o):we(o)?r[i]=o.slice():(!t||!be(o))&&(r[i]=o)};for(let o=0,a=arguments.length;o<a;o++)arguments[o]&&Pe(arguments[o],n);return r}const Ks=(e,t,r,{allOwnKeys:n}={})=>(Pe(t,(o,a)=>{r&&W(o)?e[a]=Gt(o,r):e[a]=o},{allOwnKeys:n}),e),Gs=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Xs=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Zs=(e,t,r,n)=>{let o,a,i;const l={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)i=o[a],(!n||n(i,e,t))&&!l[i]&&(t[i]=e[i],l[i]=!0);e=r!==!1&&pt(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Qs=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},en=e=>{if(!e)return null;if(we(e))return e;let t=e.length;if(!Qt(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},tn=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&pt(Uint8Array)),rn=(e,t)=>{const n=(e&&e[Ve]).call(e);let o;for(;(o=n.next())&&!o.done;){const a=o.value;t.call(e,a[0],a[1])}},sn=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},nn=ee("HTMLFormElement"),on=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,o){return n.toUpperCase()+o}),Nt=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),an=ee("RegExp"),rr=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Pe(r,(o,a)=>{let i;(i=t(o,a,e))!==!1&&(n[a]=i||o)}),Object.defineProperties(e,n)},ln=e=>{rr(e,(t,r)=>{if(W(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(W(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},cn=(e,t)=>{const r={},n=o=>{o.forEach(a=>{r[a]=!0})};return we(e)?n(e):n(String(e).split(t)),r},dn=()=>{},un=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function mn(e){return!!(e&&W(e.append)&&e[Xt]==="FormData"&&e[Ve])}const fn=e=>{const t=new Array(10),r=(n,o)=>{if(Re(n)){if(t.indexOf(n)>=0)return;if(Oe(n))return n;if(!("toJSON"in n)){t[o]=n;const a=we(n)?[]:{};return Pe(n,(i,l)=>{const m=r(i,o+1);!be(m)&&(a[l]=m)}),t[o]=void 0,a}}return n};return r(e,0)},hn=ee("AsyncFunction"),pn=e=>e&&(Re(e)||W(e))&&W(e.then)&&W(e.catch),sr=((e,t)=>e?setImmediate:t?((r,n)=>(pe.addEventListener("message",({source:o,data:a})=>{o===pe&&a===r&&n.length&&n.shift()()},!1),o=>{n.push(o),pe.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",W(pe.postMessage)),gn=typeof queueMicrotask<"u"?queueMicrotask.bind(pe):typeof process<"u"&&process.nextTick||sr,yn=e=>e!=null&&W(e[Ve]),d={isArray:we,isArrayBuffer:Zt,isBuffer:Oe,isFormData:zs,isArrayBufferView:Ts,isString:ks,isNumber:Qt,isBoolean:Is,isObject:Re,isPlainObject:De,isEmptyObject:Ds,isReadableStream:Hs,isRequest:Ws,isResponse:Vs,isHeaders:Js,isUndefined:be,isDate:Fs,isFile:Ls,isBlob:Bs,isRegExp:an,isFunction:W,isStream:$s,isURLSearchParams:qs,isTypedArray:tn,isFileList:Us,forEach:Pe,merge:lt,extend:Ks,trim:Ys,stripBOM:Gs,inherits:Xs,toFlatObject:Zs,kindOf:Je,kindOfTest:ee,endsWith:Qs,toArray:en,forEachEntry:rn,matchAll:sn,isHTMLForm:nn,hasOwnProperty:Nt,hasOwnProp:Nt,reduceDescriptors:rr,freezeMethods:ln,toObjectSet:cn,toCamelCase:on,noop:dn,toFiniteNumber:un,findKey:er,global:pe,isContextDefined:tr,isSpecCompliantForm:mn,toJSONObject:fn,isAsyncFn:hn,isThenable:pn,setImmediate:sr,asap:gn,isIterable:yn};function N(e,t,r,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),o&&(this.response=o,this.status=o.status?o.status:null)}d.inherits(N,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:d.toJSONObject(this.config),code:this.code,status:this.status}}});const nr=N.prototype,or={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{or[e]={value:e}});Object.defineProperties(N,or);Object.defineProperty(nr,"isAxiosError",{value:!0});N.from=(e,t,r,n,o,a)=>{const i=Object.create(nr);d.toFlatObject(e,i,function(c){return c!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",m=t==null&&e?e.code:t;return N.call(i,l,m,r,n,o),e&&i.cause==null&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",a&&Object.assign(i,a),i};const xn=null;function ct(e){return d.isPlainObject(e)||d.isArray(e)}function ir(e){return d.endsWith(e,"[]")?e.slice(0,-2):e}function St(e,t,r){return e?e.concat(t).map(function(o,a){return o=ir(o),!r&&a?"["+o+"]":o}).join(r?".":""):t}function bn(e){return d.isArray(e)&&!e.some(ct)}const wn=d.toFlatObject(d,{},null,function(t){return/^is[A-Z]/.test(t)});function Ke(e,t,r){if(!d.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=d.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,x){return!d.isUndefined(x[b])});const n=r.metaTokens,o=r.visitor||c,a=r.dots,i=r.indexes,m=(r.Blob||typeof Blob<"u"&&Blob)&&d.isSpecCompliantForm(t);if(!d.isFunction(o))throw new TypeError("visitor must be a function");function u(f){if(f===null)return"";if(d.isDate(f))return f.toISOString();if(d.isBoolean(f))return f.toString();if(!m&&d.isBlob(f))throw new N("Blob is not supported. Use a Buffer instead.");return d.isArrayBuffer(f)||d.isTypedArray(f)?m&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function c(f,b,x){let R=f;if(f&&!x&&typeof f=="object"){if(d.endsWith(b,"{}"))b=n?b:b.slice(0,-2),f=JSON.stringify(f);else if(d.isArray(f)&&bn(f)||(d.isFileList(f)||d.endsWith(b,"[]"))&&(R=d.toArray(f)))return b=ir(b),R.forEach(function(S,A){!(d.isUndefined(S)||S===null)&&t.append(i===!0?St([b],A,a):i===null?b:b+"[]",u(S))}),!1}return ct(f)?!0:(t.append(St(x,b,a),u(f)),!1)}const h=[],v=Object.assign(wn,{defaultVisitor:c,convertValue:u,isVisitable:ct});function j(f,b){if(!d.isUndefined(f)){if(h.indexOf(f)!==-1)throw Error("Circular reference detected in "+b.join("."));h.push(f),d.forEach(f,function(R,_){(!(d.isUndefined(R)||R===null)&&o.call(t,R,d.isString(_)?_.trim():_,b,v))===!0&&j(R,b?b.concat(_):[_])}),h.pop()}}if(!d.isObject(e))throw new TypeError("data must be an object");return j(e),t}function Et(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function gt(e,t){this._pairs=[],e&&Ke(e,this,t)}const ar=gt.prototype;ar.append=function(t,r){this._pairs.push([t,r])};ar.toString=function(t){const r=t?function(n){return t.call(this,n,Et)}:Et;return this._pairs.map(function(o){return r(o[0])+"="+r(o[1])},"").join("&")};function vn(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function lr(e,t,r){if(!t)return e;const n=r&&r.encode||vn;d.isFunction(r)&&(r={serialize:r});const o=r&&r.serialize;let a;if(o?a=o(t,r):a=d.isURLSearchParams(t)?t.toString():new gt(t,r).toString(n),a){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class jn{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){d.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Ot=jn,cr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Nn=typeof URLSearchParams<"u"?URLSearchParams:gt,Sn=typeof FormData<"u"?FormData:null,En=typeof Blob<"u"?Blob:null,On={isBrowser:!0,classes:{URLSearchParams:Nn,FormData:Sn,Blob:En},protocols:["http","https","file","blob","url","data"]},yt=typeof window<"u"&&typeof document<"u",dt=typeof navigator=="object"&&navigator||void 0,Rn=yt&&(!dt||["ReactNative","NativeScript","NS"].indexOf(dt.product)<0),Pn=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),_n=yt&&window.location.href||"http://localhost",Cn=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:yt,hasStandardBrowserEnv:Rn,hasStandardBrowserWebWorkerEnv:Pn,navigator:dt,origin:_n},Symbol.toStringTag,{value:"Module"})),q={...Cn,...On};function An(e,t){return Ke(e,new q.classes.URLSearchParams,{visitor:function(r,n,o,a){return q.isNode&&d.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function Mn(e){return d.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Tn(e){const t={},r=Object.keys(e);let n;const o=r.length;let a;for(n=0;n<o;n++)a=r[n],t[a]=e[a];return t}function dr(e){function t(r,n,o,a){let i=r[a++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),m=a>=r.length;return i=!i&&d.isArray(o)?o.length:i,m?(d.hasOwnProp(o,i)?o[i]=[o[i],n]:o[i]=n,!l):((!o[i]||!d.isObject(o[i]))&&(o[i]=[]),t(r,n,o[i],a)&&d.isArray(o[i])&&(o[i]=Tn(o[i])),!l)}if(d.isFormData(e)&&d.isFunction(e.entries)){const r={};return d.forEachEntry(e,(n,o)=>{t(Mn(n),o,r,0)}),r}return null}function kn(e,t,r){if(d.isString(e))try{return(t||JSON.parse)(e),d.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const xt={transitional:cr,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",o=n.indexOf("application/json")>-1,a=d.isObject(t);if(a&&d.isHTMLForm(t)&&(t=new FormData(t)),d.isFormData(t))return o?JSON.stringify(dr(t)):t;if(d.isArrayBuffer(t)||d.isBuffer(t)||d.isStream(t)||d.isFile(t)||d.isBlob(t)||d.isReadableStream(t))return t;if(d.isArrayBufferView(t))return t.buffer;if(d.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return An(t,this.formSerializer).toString();if((l=d.isFileList(t))||n.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return Ke(l?{"files[]":t}:t,m&&new m,this.formSerializer)}}return a||o?(r.setContentType("application/json",!1),kn(t)):t}],transformResponse:[function(t){const r=this.transitional||xt.transitional,n=r&&r.forcedJSONParsing,o=this.responseType==="json";if(d.isResponse(t)||d.isReadableStream(t))return t;if(t&&d.isString(t)&&(n&&!this.responseType||o)){const i=!(r&&r.silentJSONParsing)&&o;try{return JSON.parse(t,this.parseReviver)}catch(l){if(i)throw l.name==="SyntaxError"?N.from(l,N.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:q.classes.FormData,Blob:q.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};d.forEach(["delete","get","head","post","put","patch"],e=>{xt.headers[e]={}});const bt=xt,In=d.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Dn=e=>{const t={};let r,n,o;return e&&e.split(`
`).forEach(function(i){o=i.indexOf(":"),r=i.substring(0,o).trim().toLowerCase(),n=i.substring(o+1).trim(),!(!r||t[r]&&In[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Rt=Symbol("internals");function Ne(e){return e&&String(e).trim().toLowerCase()}function Fe(e){return e===!1||e==null?e:d.isArray(e)?e.map(Fe):String(e)}function Fn(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const Ln=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function tt(e,t,r,n,o){if(d.isFunction(n))return n.call(this,t,r);if(o&&(t=r),!!d.isString(t)){if(d.isString(n))return t.indexOf(n)!==-1;if(d.isRegExp(n))return n.test(t)}}function Bn(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function Un(e,t){const r=d.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(o,a,i){return this[n].call(this,t,o,a,i)},configurable:!0})})}class Ge{constructor(t){t&&this.set(t)}set(t,r,n){const o=this;function a(l,m,u){const c=Ne(m);if(!c)throw new Error("header name must be a non-empty string");const h=d.findKey(o,c);(!h||o[h]===void 0||u===!0||u===void 0&&o[h]!==!1)&&(o[h||m]=Fe(l))}const i=(l,m)=>d.forEach(l,(u,c)=>a(u,c,m));if(d.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(d.isString(t)&&(t=t.trim())&&!Ln(t))i(Dn(t),r);else if(d.isObject(t)&&d.isIterable(t)){let l={},m,u;for(const c of t){if(!d.isArray(c))throw TypeError("Object iterator must return a key-value pair");l[u=c[0]]=(m=l[u])?d.isArray(m)?[...m,c[1]]:[m,c[1]]:c[1]}i(l,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=Ne(t),t){const n=d.findKey(this,t);if(n){const o=this[n];if(!r)return o;if(r===!0)return Fn(o);if(d.isFunction(r))return r.call(this,o,n);if(d.isRegExp(r))return r.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Ne(t),t){const n=d.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||tt(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let o=!1;function a(i){if(i=Ne(i),i){const l=d.findKey(n,i);l&&(!r||tt(n,n[l],l,r))&&(delete n[l],o=!0)}}return d.isArray(t)?t.forEach(a):a(t),o}clear(t){const r=Object.keys(this);let n=r.length,o=!1;for(;n--;){const a=r[n];(!t||tt(this,this[a],a,t,!0))&&(delete this[a],o=!0)}return o}normalize(t){const r=this,n={};return d.forEach(this,(o,a)=>{const i=d.findKey(n,a);if(i){r[i]=Fe(o),delete r[a];return}const l=t?Bn(a):String(a).trim();l!==a&&delete r[a],r[l]=Fe(o),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return d.forEach(this,(n,o)=>{n!=null&&n!==!1&&(r[o]=t&&d.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(o=>n.set(o)),n}static accessor(t){const n=(this[Rt]=this[Rt]={accessors:{}}).accessors,o=this.prototype;function a(i){const l=Ne(i);n[l]||(Un(o,i),n[l]=!0)}return d.isArray(t)?t.forEach(a):a(t),this}}Ge.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);d.reduceDescriptors(Ge.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});d.freezeMethods(Ge);const Q=Ge;function rt(e,t){const r=this||bt,n=t||r,o=Q.from(n.headers);let a=n.data;return d.forEach(e,function(l){a=l.call(r,a,o.normalize(),t?t.status:void 0)}),o.normalize(),a}function ur(e){return!!(e&&e.__CANCEL__)}function ve(e,t,r){N.call(this,e??"canceled",N.ERR_CANCELED,t,r),this.name="CanceledError"}d.inherits(ve,N,{__CANCEL__:!0});function mr(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new N("Request failed with status code "+r.status,[N.ERR_BAD_REQUEST,N.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function $n(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function zn(e,t){e=e||10;const r=new Array(e),n=new Array(e);let o=0,a=0,i;return t=t!==void 0?t:1e3,function(m){const u=Date.now(),c=n[a];i||(i=u),r[o]=m,n[o]=u;let h=a,v=0;for(;h!==o;)v+=r[h++],h=h%e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),u-i<t)return;const j=c&&u-c;return j?Math.round(v*1e3/j):void 0}}function qn(e,t){let r=0,n=1e3/t,o,a;const i=(u,c=Date.now())=>{r=c,o=null,a&&(clearTimeout(a),a=null),e(...u)};return[(...u)=>{const c=Date.now(),h=c-r;h>=n?i(u,c):(o=u,a||(a=setTimeout(()=>{a=null,i(o)},n-h)))},()=>o&&i(o)]}const $e=(e,t,r=3)=>{let n=0;const o=zn(50,250);return qn(a=>{const i=a.loaded,l=a.lengthComputable?a.total:void 0,m=i-n,u=o(m),c=i<=l;n=i;const h={loaded:i,total:l,progress:l?i/l:void 0,bytes:m,rate:u||void 0,estimated:u&&l&&c?(l-i)/u:void 0,event:a,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(h)},r)},Pt=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},_t=e=>(...t)=>d.asap(()=>e(...t)),Hn=q.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,q.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(q.origin),q.navigator&&/(msie|trident)/i.test(q.navigator.userAgent)):()=>!0,Wn=q.hasStandardBrowserEnv?{write(e,t,r,n,o,a){const i=[e+"="+encodeURIComponent(t)];d.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),d.isString(n)&&i.push("path="+n),d.isString(o)&&i.push("domain="+o),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Vn(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Jn(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function fr(e,t,r){let n=!Vn(t);return e&&(n||r==!1)?Jn(e,t):t}const Ct=e=>e instanceof Q?{...e}:e;function ge(e,t){t=t||{};const r={};function n(u,c,h,v){return d.isPlainObject(u)&&d.isPlainObject(c)?d.merge.call({caseless:v},u,c):d.isPlainObject(c)?d.merge({},c):d.isArray(c)?c.slice():c}function o(u,c,h,v){if(d.isUndefined(c)){if(!d.isUndefined(u))return n(void 0,u,h,v)}else return n(u,c,h,v)}function a(u,c){if(!d.isUndefined(c))return n(void 0,c)}function i(u,c){if(d.isUndefined(c)){if(!d.isUndefined(u))return n(void 0,u)}else return n(void 0,c)}function l(u,c,h){if(h in t)return n(u,c);if(h in e)return n(void 0,u)}const m={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(u,c,h)=>o(Ct(u),Ct(c),h,!0)};return d.forEach(Object.keys({...e,...t}),function(c){const h=m[c]||o,v=h(e[c],t[c],c);d.isUndefined(v)&&h!==l||(r[c]=v)}),r}const hr=e=>{const t=ge({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:o,xsrfCookieName:a,headers:i,auth:l}=t;if(t.headers=i=Q.from(i),t.url=lr(fr(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),d.isFormData(r)){if(q.hasStandardBrowserEnv||q.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(d.isFunction(r.getHeaders)){const m=r.getHeaders(),u=["content-type","content-length"];Object.entries(m).forEach(([c,h])=>{u.includes(c.toLowerCase())&&i.set(c,h)})}}if(q.hasStandardBrowserEnv&&(n&&d.isFunction(n)&&(n=n(t)),n||n!==!1&&Hn(t.url))){const m=o&&a&&Wn.read(a);m&&i.set(o,m)}return t},Yn=typeof XMLHttpRequest<"u",Kn=Yn&&function(e){return new Promise(function(r,n){const o=hr(e);let a=o.data;const i=Q.from(o.headers).normalize();let{responseType:l,onUploadProgress:m,onDownloadProgress:u}=o,c,h,v,j,f;function b(){j&&j(),f&&f(),o.cancelToken&&o.cancelToken.unsubscribe(c),o.signal&&o.signal.removeEventListener("abort",c)}let x=new XMLHttpRequest;x.open(o.method.toUpperCase(),o.url,!0),x.timeout=o.timeout;function R(){if(!x)return;const S=Q.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),p={data:!l||l==="text"||l==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:S,config:e,request:x};mr(function(C){r(C),b()},function(C){n(C),b()},p),x=null}"onloadend"in x?x.onloadend=R:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(R)},x.onabort=function(){x&&(n(new N("Request aborted",N.ECONNABORTED,e,x)),x=null)},x.onerror=function(A){const p=A&&A.message?A.message:"Network Error",O=new N(p,N.ERR_NETWORK,e,x);O.event=A||null,n(O),x=null},x.ontimeout=function(){let A=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const p=o.transitional||cr;o.timeoutErrorMessage&&(A=o.timeoutErrorMessage),n(new N(A,p.clarifyTimeoutError?N.ETIMEDOUT:N.ECONNABORTED,e,x)),x=null},a===void 0&&i.setContentType(null),"setRequestHeader"in x&&d.forEach(i.toJSON(),function(A,p){x.setRequestHeader(p,A)}),d.isUndefined(o.withCredentials)||(x.withCredentials=!!o.withCredentials),l&&l!=="json"&&(x.responseType=o.responseType),u&&([v,f]=$e(u,!0),x.addEventListener("progress",v)),m&&x.upload&&([h,j]=$e(m),x.upload.addEventListener("progress",h),x.upload.addEventListener("loadend",j)),(o.cancelToken||o.signal)&&(c=S=>{x&&(n(!S||S.type?new ve(null,e,x):S),x.abort(),x=null)},o.cancelToken&&o.cancelToken.subscribe(c),o.signal&&(o.signal.aborted?c():o.signal.addEventListener("abort",c)));const _=$n(o.url);if(_&&q.protocols.indexOf(_)===-1){n(new N("Unsupported protocol "+_+":",N.ERR_BAD_REQUEST,e));return}x.send(a||null)})},Gn=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,o;const a=function(u){if(!o){o=!0,l();const c=u instanceof Error?u:this.reason;n.abort(c instanceof N?c:new ve(c instanceof Error?c.message:c))}};let i=t&&setTimeout(()=>{i=null,a(new N(`timeout ${t} of ms exceeded`,N.ETIMEDOUT))},t);const l=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),e=null)};e.forEach(u=>u.addEventListener("abort",a));const{signal:m}=n;return m.unsubscribe=()=>d.asap(l),m}},Xn=Gn,Zn=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let n=0,o;for(;n<r;)o=n+t,yield e.slice(n,o),n=o},Qn=async function*(e,t){for await(const r of eo(e))yield*Zn(r,t)},eo=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},At=(e,t,r,n)=>{const o=Qn(e,t);let a=0,i,l=m=>{i||(i=!0,n&&n(m))};return new ReadableStream({async pull(m){try{const{done:u,value:c}=await o.next();if(u){l(),m.close();return}let h=c.byteLength;if(r){let v=a+=h;r(v)}m.enqueue(new Uint8Array(c))}catch(u){throw l(u),u}},cancel(m){return l(m),o.return()}},{highWaterMark:2})},Mt=64*1024,{isFunction:ke}=d,to=(({Request:e,Response:t})=>({Request:e,Response:t}))(d.global),{ReadableStream:Tt,TextEncoder:kt}=d.global,It=(e,...t)=>{try{return!!e(...t)}catch{return!1}},ro=e=>{e=d.merge.call({skipUndefined:!0},to,e);const{fetch:t,Request:r,Response:n}=e,o=t?ke(t):typeof fetch=="function",a=ke(r),i=ke(n);if(!o)return!1;const l=o&&ke(Tt),m=o&&(typeof kt=="function"?(f=>b=>f.encode(b))(new kt):async f=>new Uint8Array(await new r(f).arrayBuffer())),u=a&&l&&It(()=>{let f=!1;const b=new r(q.origin,{body:new Tt,method:"POST",get duplex(){return f=!0,"half"}}).headers.has("Content-Type");return f&&!b}),c=i&&l&&It(()=>d.isReadableStream(new n("").body)),h={stream:c&&(f=>f.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(f=>{!h[f]&&(h[f]=(b,x)=>{let R=b&&b[f];if(R)return R.call(b);throw new N(`Response type '${f}' is not supported`,N.ERR_NOT_SUPPORT,x)})});const v=async f=>{if(f==null)return 0;if(d.isBlob(f))return f.size;if(d.isSpecCompliantForm(f))return(await new r(q.origin,{method:"POST",body:f}).arrayBuffer()).byteLength;if(d.isArrayBufferView(f)||d.isArrayBuffer(f))return f.byteLength;if(d.isURLSearchParams(f)&&(f=f+""),d.isString(f))return(await m(f)).byteLength},j=async(f,b)=>{const x=d.toFiniteNumber(f.getContentLength());return x??v(b)};return async f=>{let{url:b,method:x,data:R,signal:_,cancelToken:S,timeout:A,onDownloadProgress:p,onUploadProgress:O,responseType:C,headers:I,withCredentials:F="same-origin",fetchOptions:V}=hr(f),je=t||fetch;C=C?(C+"").toLowerCase():"text";let J=Xn([_,S&&S.toAbortSignal()],A),ae=null;const te=J&&J.unsubscribe&&(()=>{J.unsubscribe()});let le;try{if(O&&u&&x!=="get"&&x!=="head"&&(le=await j(I,R))!==0){let G=new r(b,{method:"POST",body:R,duplex:"half"}),ce;if(d.isFormData(R)&&(ce=G.headers.get("content-type"))&&I.setContentType(ce),G.body){const[me,fe]=Pt(le,$e(_t(O)));R=At(G.body,Mt,me,fe)}}d.isString(F)||(F=F?"include":"omit");const k=a&&"credentials"in r.prototype,ne={...V,signal:J,method:x.toUpperCase(),headers:I.normalize().toJSON(),body:R,duplex:"half",credentials:k?F:void 0};ae=a&&new r(b,ne);let Z=await(a?je(ae,V):je(b,ne));const Ze=c&&(C==="stream"||C==="response");if(c&&(p||Ze&&te)){const G={};["status","statusText","headers"].forEach(_e=>{G[_e]=Z[_e]});const ce=d.toFiniteNumber(Z.headers.get("content-length")),[me,fe]=p&&Pt(ce,$e(_t(p),!0))||[];Z=new n(At(Z.body,Mt,me,()=>{fe&&fe(),te&&te()}),G)}C=C||"text";let Qe=await h[d.findKey(h,C)||"text"](Z,f);return!Ze&&te&&te(),await new Promise((G,ce)=>{mr(G,ce,{data:Qe,headers:Q.from(Z.headers),status:Z.status,statusText:Z.statusText,config:f,request:ae})})}catch(k){throw te&&te(),k&&k.name==="TypeError"&&/Load failed|fetch/i.test(k.message)?Object.assign(new N("Network Error",N.ERR_NETWORK,f,ae),{cause:k.cause||k}):N.from(k,k&&k.code,f,ae)}}},so=new Map,pr=e=>{let t=e?e.env:{};const{fetch:r,Request:n,Response:o}=t,a=[n,o,r];let i=a.length,l=i,m,u,c=so;for(;l--;)m=a[l],u=c.get(m),u===void 0&&c.set(m,u=l?new Map:ro(t)),c=u;return u};pr();const ut={http:xn,xhr:Kn,fetch:{get:pr}};d.forEach(ut,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Dt=e=>`- ${e}`,no=e=>d.isFunction(e)||e===null||e===!1,gr={getAdapter:(e,t)=>{e=d.isArray(e)?e:[e];const{length:r}=e;let n,o;const a={};for(let i=0;i<r;i++){n=e[i];let l;if(o=n,!no(n)&&(o=ut[(l=String(n)).toLowerCase()],o===void 0))throw new N(`Unknown adapter '${l}'`);if(o&&(d.isFunction(o)||(o=o.get(t))))break;a[l||"#"+i]=o}if(!o){const i=Object.entries(a).map(([m,u])=>`adapter ${m} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?i.length>1?`since :
`+i.map(Dt).join(`
`):" "+Dt(i[0]):"as no adapter specified";throw new N("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return o},adapters:ut};function st(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ve(null,e)}function Ft(e){return st(e),e.headers=Q.from(e.headers),e.data=rt.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),gr.getAdapter(e.adapter||bt.adapter,e)(e).then(function(n){return st(e),n.data=rt.call(e,e.transformResponse,n),n.headers=Q.from(n.headers),n},function(n){return ur(n)||(st(e),n&&n.response&&(n.response.data=rt.call(e,e.transformResponse,n.response),n.response.headers=Q.from(n.response.headers))),Promise.reject(n)})}const yr="1.12.2",Xe={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Xe[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Lt={};Xe.transitional=function(t,r,n){function o(a,i){return"[Axios v"+yr+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,l)=>{if(t===!1)throw new N(o(i," has been removed"+(r?" in "+r:"")),N.ERR_DEPRECATED);return r&&!Lt[i]&&(Lt[i]=!0,console.warn(o(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,i,l):!0}};Xe.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function oo(e,t,r){if(typeof e!="object")throw new N("options must be an object",N.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let o=n.length;for(;o-- >0;){const a=n[o],i=t[a];if(i){const l=e[a],m=l===void 0||i(l,a,e);if(m!==!0)throw new N("option "+a+" must be "+m,N.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new N("Unknown option "+a,N.ERR_BAD_OPTION)}}const Le={assertOptions:oo,validators:Xe},re=Le.validators;class ze{constructor(t){this.defaults=t||{},this.interceptors={request:new Ot,response:new Ot}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ge(this.defaults,r);const{transitional:n,paramsSerializer:o,headers:a}=r;n!==void 0&&Le.assertOptions(n,{silentJSONParsing:re.transitional(re.boolean),forcedJSONParsing:re.transitional(re.boolean),clarifyTimeoutError:re.transitional(re.boolean)},!1),o!=null&&(d.isFunction(o)?r.paramsSerializer={serialize:o}:Le.assertOptions(o,{encode:re.function,serialize:re.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Le.assertOptions(r,{baseUrl:re.spelling("baseURL"),withXsrfToken:re.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&d.merge(a.common,a[r.method]);a&&d.forEach(["delete","get","head","post","put","patch","common"],f=>{delete a[f]}),r.headers=Q.concat(i,a);const l=[];let m=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(r)===!1||(m=m&&b.synchronous,l.unshift(b.fulfilled,b.rejected))});const u=[];this.interceptors.response.forEach(function(b){u.push(b.fulfilled,b.rejected)});let c,h=0,v;if(!m){const f=[Ft.bind(this),void 0];for(f.unshift(...l),f.push(...u),v=f.length,c=Promise.resolve(r);h<v;)c=c.then(f[h++],f[h++]);return c}v=l.length;let j=r;for(;h<v;){const f=l[h++],b=l[h++];try{j=f(j)}catch(x){b.call(this,x);break}}try{c=Ft.call(this,j)}catch(f){return Promise.reject(f)}for(h=0,v=u.length;h<v;)c=c.then(u[h++],u[h++]);return c}getUri(t){t=ge(this.defaults,t);const r=fr(t.baseURL,t.url,t.allowAbsoluteUrls);return lr(r,t.params,t.paramsSerializer)}}d.forEach(["delete","get","head","options"],function(t){ze.prototype[t]=function(r,n){return this.request(ge(n||{},{method:t,url:r,data:(n||{}).data}))}});d.forEach(["post","put","patch"],function(t){function r(n){return function(a,i,l){return this.request(ge(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}ze.prototype[t]=r(),ze.prototype[t+"Form"]=r(!0)});const Be=ze;class wt{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(o=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](o);n._listeners=null}),this.promise.then=o=>{let a;const i=new Promise(l=>{n.subscribe(l),a=l}).then(o);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,l){n.reason||(n.reason=new ve(a,i,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new wt(function(o){t=o}),cancel:t}}}const io=wt;function ao(e){return function(r){return e.apply(null,r)}}function lo(e){return d.isObject(e)&&e.isAxiosError===!0}const mt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(mt).forEach(([e,t])=>{mt[t]=e});const co=mt;function xr(e){const t=new Be(e),r=Gt(Be.prototype.request,t);return d.extend(r,Be.prototype,t,{allOwnKeys:!0}),d.extend(r,t,null,{allOwnKeys:!0}),r.create=function(o){return xr(ge(e,o))},r}const D=xr(bt);D.Axios=Be;D.CanceledError=ve;D.CancelToken=io;D.isCancel=ur;D.VERSION=yr;D.toFormData=Ke;D.AxiosError=N;D.Cancel=D.CanceledError;D.all=function(t){return Promise.all(t)};D.spread=ao;D.isAxiosError=lo;D.mergeConfig=ge;D.AxiosHeaders=Q;D.formToJSON=e=>dr(d.isHTMLForm(e)?new FormData(e):e);D.getAdapter=gr.getAdapter;D.HttpStatusCode=co;D.default=D;const Se=D,uo=({user:e,userProfile:t})=>{var r,n,o;if(console.log("ChatPage rendering with:",{user:e==null?void 0:e.email,userProfile:t==null?void 0:t.first_name}),!e)return console.log("ChatPage: No user provided"),s.jsx("div",{children:"No user found"});try{const[a,i]=w.useState([]),[l,m]=w.useState(""),u=ft(),[c,h]=w.useState(!1),[v,j]=w.useState(null),[f,b]=w.useState(!1),[x,R]=w.useState([]),[_,S]=w.useState(navigator.onLine),[A,p]=w.useState(null),[O,C]=w.useState(""),[I,F]=w.useState(!1),[V,je]=w.useState(null),[J,ae]=w.useState(!1),te=w.useRef(null),le=w.useRef(null),k=w.useMemo(()=>{const y=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),E=/iPad|iPhone|iPod/.test(navigator.userAgent),M=/Android/.test(navigator.userAgent),T=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return{isMobile:y,isIOS:E,isAndroid:M,isSafari:T,hasMediaDevices:!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),hasFileReader:typeof FileReader<"u",hasIndexedDB:"indexedDB"in window,hasLocalStorage:(()=>{try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch{return!1}})(),hasFormData:typeof FormData<"u",hasBlob:typeof Blob<"u"}},[]),ne=w.useMemo(()=>{var y;return t!=null&&t.first_name?t.first_name:(y=e==null?void 0:e.user_metadata)!=null&&y.first_name?e.user_metadata.first_name:e!=null&&e.email?e.email.split("@")[0]:"there"},[t==null?void 0:t.first_name,(r=e==null?void 0:e.user_metadata)==null?void 0:r.first_name,e==null?void 0:e.email]),Z=w.useMemo(()=>!!(e&&ne),[e,ne]),Ze=w.useMemo(()=>[...x].sort((y,E)=>new Date(E.last_message_at||E.created_at)-new Date(y.last_message_at||y.created_at)),[x]);w.useEffect(()=>{Z&&(console.log("ChatPage ready, initializing chat for:",ne),G())},[Z,G]),w.useEffect(()=>{Qe()},[a]),w.useEffect(()=>{const y=()=>{S(!0),g.success("Connection restored")},E=()=>{S(!1),g.error("Connection lost. Some features may not work.")};return window.addEventListener("online",y),window.addEventListener("offline",E),()=>{window.removeEventListener("online",y),window.removeEventListener("offline",E)}},[]),w.useEffect(()=>()=>{V&&V.state==="recording"&&V.stop(),A&&(p(null),C(""))},[]);const Qe=w.useCallback(()=>{var y;(y=te.current)==null||y.scrollIntoView({behavior:"smooth"})},[]),G=w.useCallback(async()=>{try{const y={id:`welcome-${Date.now()}`,sender_type:"momi",content:`Hi ${ne}! ðŸ˜Š I'm MOMi, your personalized wellness assistant. I'm here to support you with advice based on the 7 Pillars of Wellness. How can I help you today?`,timestamp:new Date().toISOString()};i([y])}catch(y){console.error("Error initializing chat:",y);const E={id:`welcome-fallback-${Date.now()}`,sender_type:"momi",content:"Hi there! ðŸ˜Š I'm MOMi, your personalized wellness assistant. I'm here to support you with advice based on the 7 Pillars of Wellness. How can I help you today?",timestamp:new Date().toISOString()};i([E])}},[ne]),ce=async()=>{var y,E;if(e!=null&&e.id)try{const M=(y=(await z.auth.getSession()).data.session)==null?void 0:y.access_token;if(!M){console.error("No authentication token available");return}const L=(await Se.get("/api/chat/conversations",{headers:{Authorization:`Bearer ${M}`}})).data.sort((P,B)=>new Date(B.last_message_at||B.created_at)-new Date(P.last_message_at||P.created_at));R(L),console.log(`Loaded ${L.length} conversations for ${ne}`)}catch(M){console.error("Error fetching conversations:",M),((E=M.response)==null?void 0:E.status)===401&&g.error("Session expired. Please log in again.")}},me=async(y=l,E=A)=>{var T,L,P,B,he,X,ye,Ce;if(!(y!=null&&y.trim())&&!E||c)return;if(!_){g.error("No internet connection. Please check your network and try again.");return}const M={id:Date.now(),sender_type:"user",content:y||(E?"[Image]":""),timestamp:new Date().toISOString(),image:E?O:null};i(Y=>[...Y,M]),h(!0),m(""),p(null),C(""),le.current&&(le.current.value="");try{const Y=(T=(await z.auth.getSession()).data.session)==null?void 0:T.access_token;if(!Y)throw new Error("No authentication token available");let H={message:y,conversationId:v};if(E)try{const $=new FormData;$.append("image",E),$.append("message",y||""),$.append("conversationId",v||""),$.append("userId",e.id);const Ae=await Se.post("/api/chat/upload",$,{headers:{Authorization:`Bearer ${Y}`,"Content-Type":"multipart/form-data"},timeout:6e4,maxContentLength:10*1024*1024,maxBodyLength:10*1024*1024});if(!((L=Ae.data)!=null&&L.imageUrl))throw new Error("Invalid response from image upload service");H.imageUrl=Ae.data.imageUrl}catch($){console.error("Image upload failed:",$),i(Ae=>Ae.slice(0,-1)),$.code==="ECONNABORTED"?g.error("Image upload timed out. Please try with a smaller image."):((P=$.response)==null?void 0:P.status)===413?g.error("Image is too large. Please use an image smaller than 10MB."):((B=$.response)==null?void 0:B.status)===401?(g.error("Session expired. Please log in again."),setTimeout(()=>u("/login"),2e3)):g.error("Failed to upload image. Please try again."),h(!1);return}H.userId=e.id,H.userEmail=e.email;const K=await Se.post("/api/chat/message",H,{headers:{Authorization:`Bearer ${Y}`,"Content-Type":"application/json","X-User-ID":e.id},timeout:3e4});if(!K.data||typeof K.data.reply!="string")throw new Error("Invalid response from chat service");const et={id:K.data.messageId||`${Date.now()}-${Math.random()}`,sender_type:"momi",content:K.data.reply,timestamp:K.data.timestamp||new Date().toISOString(),conversationId:K.data.conversationId};i($=>[...$,et]),K.data.conversationId&&!v&&j(K.data.conversationId)}catch(Y){console.error("Error sending message:",Y),i($=>$.slice(0,-1));let H="I apologize, but I'm having trouble responding right now. Please try again.",K=!1;Y.code==="ECONNABORTED"?(H="Request timed out. Please check your connection and try again.",g.error("Message timed out. Please try again.")):((he=Y.response)==null?void 0:he.status)===401?(H="Your session has expired. Please log in again.",g.error("Session expired. Please log in again."),setTimeout(()=>u("/login"),2e3)):((X=Y.response)==null?void 0:X.status)===403?(H="Access denied. Please check your permissions.",g.error("Access denied. Please log in again."),setTimeout(()=>u("/login"),2e3)):((ye=Y.response)==null?void 0:ye.status)===429?(H="Too many requests. Please wait a moment before sending another message.",g.error("Please wait a moment before sending another message.")):((Ce=Y.response)==null?void 0:Ce.status)>=500?(H="Our servers are temporarily unavailable. Please try again in a moment.",g.error("Server temporarily unavailable. Please try again."),K=!0):navigator.onLine?(g.error("Failed to send message. Please try again."),K=!0):(H="You appear to be offline. Please check your internet connection.",g.error("You appear to be offline. Please check your connection."),K=!0);const et={id:`error-${Date.now()}-${Math.random()}`,sender_type:"momi",content:H,timestamp:new Date().toISOString(),isError:!0};i($=>[...$,et]),K&&y&&setTimeout(()=>{navigator.onLine&&console.log("Auto-retrying message send...")},5e3)}finally{h(!1)}},fe=()=>{i([]),j(null),b(!1),G()},_e=async y=>{var E,M;try{setLoadingConversations(!0);const T=(E=(await z.auth.getSession()).data.session)==null?void 0:E.access_token;if(!T){g.error("Session expired. Please log in again.");return}const P=(await Se.get(`/api/chat/history/${y}`,{headers:{Authorization:`Bearer ${T}`},timeout:1e4})).data.map(B=>({id:B.id,sender_type:B.sender_type,content:B.content,timestamp:B.timestamp}));i(P),j(y),b(!1),g.success("Conversation loaded successfully")}catch(T){console.error("Error loading conversation:",T),((M=T.response)==null?void 0:M.status)===401?g.error("Session expired. Please log in again."):T.code==="ECONNABORTED"?g.error("Loading conversation timed out. Please try again."):g.error("Failed to load conversation. Please try again.")}finally{setLoadingConversations(!1)}},br=async()=>{try{const{error:y}=await z.auth.signOut();y?(console.error("Logout error:",y),g.error("Failed to log out properly")):(g.success("Logged out successfully"),u("/login",{replace:!0}))}catch(y){console.error("Unexpected logout error:",y),g.error("An unexpected error occurred during logout")}},wr=y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),me())},vr=w.useCallback(y=>{var P;const E=(P=y.target.files)==null?void 0:P[0];if(!E)return;if(!k.hasFileReader){g.error("Image upload is not supported in your browser");return}if(!k.hasFormData||!k.hasBlob){g.error("File upload is not supported in your browser");return}if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(E.type)){g.error("Please select a valid image file (JPEG, PNG, GIF, or WebP)");return}const T=k.isMobile?5*1024*1024:10*1024*1024;if(E.size>T){const B=k.isMobile?"5MB":"10MB";g.error(`Image size must be less than ${B}`);return}if(!(e!=null&&e.id)){g.error("Please log in to upload images");return}p(E);const L=new FileReader;L.onload=B=>{try{C(B.target.result),g.success("Image selected! Add a message or send as is.")}catch(he){console.error("Error reading image file:",he),g.error("Error reading image file. Please try another image."),p(null),C("")}},L.onerror=()=>{g.error("Error reading image file. Please try another image."),p(null),C("")},L.readAsDataURL(E)},[k,e==null?void 0:e.id]),jr=()=>{p(null),C(""),le.current&&(le.current.value="")},Nr=async()=>{try{if(!(e!=null&&e.id)){g.error("Please log in to use voice messages");return}if(!k.hasMediaDevices){g.error("Voice recording is not supported in your browser");return}if(!k.hasBlob){g.error("Voice recording requires modern browser features not available");return}const y={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:k.isMobile?22050:44100};k.isIOS&&(y.channelCount=1);const E=await navigator.mediaDevices.getUserMedia({audio:y}),M={mimeType:"audio/webm"};if(!MediaRecorder.isTypeSupported(M.mimeType)&&(M.mimeType="audio/ogg",!MediaRecorder.isTypeSupported(M.mimeType)&&(M.mimeType="audio/wav",!MediaRecorder.isTypeSupported(M.mimeType)))){g.error("Audio recording is not supported in your browser"),E.getTracks().forEach(P=>P.stop());return}const T=new MediaRecorder(E,M),L=[];T.ondataavailable=P=>{P.data.size>0&&L.push(P.data)},T.onstop=async()=>{try{const P=new Blob(L,{type:M.mimeType});if(P.size===0){g.error("No audio was recorded. Please try again.");return}if(P.size>25*1024*1024){g.error("Audio recording is too long. Please keep it under 5 minutes.");return}await Er(P)}catch(P){console.error("Error processing audio:",P),g.error("Error processing audio recording. Please try again.")}finally{E.getTracks().forEach(P=>P.stop())}},T.onerror=P=>{console.error("MediaRecorder error:",P.error),g.error("Recording error occurred. Please try again."),E.getTracks().forEach(B=>B.stop()),F(!1),je(null)},T.start(1e3),je(T),F(!0),g.success("Recording started! Tap again to stop.")}catch(y){console.error("Error starting recording:",y),y.name==="NotAllowedError"?g.error("Microphone access denied. Please allow microphone access and try again."):y.name==="NotFoundError"?g.error("No microphone found. Please connect a microphone and try again."):y.name==="NotSupportedError"?g.error("Audio recording is not supported in your browser."):g.error("Unable to access microphone. Please check permissions and try again.")}},Sr=()=>{V&&V.state==="recording"&&(V.stop(),F(!1),ae(!0),g.info("Processing your voice message..."))},Er=async y=>{var E,M,T,L,P,B,he;try{const X=(E=(await z.auth.getSession()).data.session)==null?void 0:E.access_token;if(!X){g.error("Session expired. Please log in again."),setTimeout(()=>u("/login"),2e3);return}const ye=new FormData,Ce=y.type.includes("webm")?".webm":y.type.includes("ogg")?".ogg":".wav";ye.append("audio",y,`voice-message-${Date.now()}${Ce}`),ye.append("userId",e.id);const H=(T=(M=(await Se.post("/api/chat/speech-to-text",ye,{headers:{Authorization:`Bearer ${X}`,"Content-Type":"multipart/form-data"},timeout:45e3,maxContentLength:25*1024*1024,maxBodyLength:25*1024*1024})).data)==null?void 0:M.transcript)==null?void 0:T.trim();H?(await me(H,A),g.success("Voice message sent!")):g.error("Could not understand the audio. Please speak clearly and try again.")}catch(X){console.error("Error transcribing audio:",X),X.code==="ECONNABORTED"?g.error("Audio processing timed out. Please try with a shorter recording."):((L=X.response)==null?void 0:L.status)===413?g.error("Audio file is too large. Please record a shorter message."):((P=X.response)==null?void 0:P.status)===401?(g.error("Session expired. Please log in again."),setTimeout(()=>u("/login"),2e3)):((B=X.response)==null?void 0:B.status)===422?g.error("Audio format not supported. Please try again."):((he=X.response)==null?void 0:he.status)===429?g.error("Too many requests. Please wait a moment and try again."):g.error("Failed to process voice message. Please try again.")}finally{ae(!1)}},Or=()=>{I?Sr():Nr()};return s.jsxs("div",{className:"chat-page-fullscreen",children:[s.jsxs("div",{className:"chat-header-compact",children:[s.jsxs("div",{className:"header-left",children:[s.jsx("img",{src:"/momi-icon-2.png",alt:"MOMi",className:"header-logo"}),s.jsxs("div",{className:"header-info",children:[s.jsx("h2",{children:"MOMi"}),s.jsxs("span",{children:["Welcome, ",(t==null?void 0:t.first_name)||((n=e==null?void 0:e.user_metadata)==null?void 0:n.first_name)||((o=e==null?void 0:e.email)==null?void 0:o.split("@")[0])||"User","!"]})]})]}),s.jsxs("div",{className:"header-right",children:[s.jsx("button",{onClick:()=>{b(!f),f||ce()},className:"hamburger-btn",title:"Chat History",children:s.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),s.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),s.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),s.jsx("button",{onClick:fe,className:"new-chat-btn-header",children:"New Chat"}),s.jsx("button",{onClick:br,className:"logout-btn-header",children:"Logout"})]})]}),s.jsxs("div",{className:"chat-container-fullwidth",children:[s.jsxs("div",{className:"messages-area",children:[a.map(y=>{var E,M,T,L,P;return s.jsxs("div",{className:`message-bubble ${y.sender_type}`,children:[s.jsx("div",{className:"message-avatar",children:y.sender_type==="momi"?s.jsx("img",{src:"/momi-icon-2.png",alt:"MOMi"}):s.jsx("div",{className:"user-avatar",children:((E=t==null?void 0:t.first_name)==null?void 0:E[0])||((T=(M=e==null?void 0:e.user_metadata)==null?void 0:M.first_name)==null?void 0:T[0])||((P=(L=e==null?void 0:e.email)==null?void 0:L[0])==null?void 0:P.toUpperCase())||"U"})}),s.jsxs("div",{className:"message-content",children:[y.image&&s.jsx("div",{className:"message-image",children:s.jsx("img",{src:y.image,alt:"Shared image",className:"message-img"})}),s.jsx("div",{className:"message-text",children:y.content}),s.jsx("div",{className:"message-timestamp",children:new Date(y.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]},y.id)}),c&&s.jsxs("div",{className:"message-bubble momi",children:[s.jsx("div",{className:"message-avatar",children:s.jsx("img",{src:"/momi-icon-2.png",alt:"MOMi"})}),s.jsx("div",{className:"message-content",children:s.jsxs("div",{className:"typing-indicator",children:[s.jsx("span",{}),s.jsx("span",{}),s.jsx("span",{})]})})]}),s.jsx("div",{ref:te})]}),O&&s.jsxs("div",{className:"image-preview-container",children:[s.jsxs("div",{className:"image-preview-wrapper",children:[s.jsx("img",{src:O,alt:"Selected",className:"image-preview"}),s.jsx("button",{onClick:jr,className:"remove-image-btn",title:"Remove image",children:"Ã—"})]}),s.jsx("p",{className:"image-preview-text",children:"Image ready to send"})]}),s.jsxs("div",{className:"input-area-fullwidth",children:[s.jsxs("div",{className:"input-controls",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:vr,ref:le,style:{display:"none"},id:"image-upload"}),s.jsx("label",{htmlFor:"image-upload",className:`attachment-btn ${c||I||J?"disabled":""}`,title:"Upload Image",children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),s.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),s.jsx("polyline",{points:"21,15 16,10 5,21"})]})}),s.jsx("button",{className:`voice-btn ${I?"recording":""} ${c||J?"disabled":""}`,onClick:Or,disabled:c||J,title:I?"Stop recording":J?"Processing...":"Voice message",children:I?s.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("rect",{x:"6",y:"6",width:"12",height:"12",rx:"2"})}):J?s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("circle",{cx:"12",cy:"12",r:"3"}),s.jsx("path",{d:"M12 1v6m0 6v6m11-7h-6m-6 0H1"})]}):s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),s.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),s.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),s.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]})})]}),s.jsxs("div",{className:"input-main",children:[s.jsx("textarea",{value:l,onChange:y=>m(y.target.value),onKeyPress:wr,placeholder:"Type your message...",className:"message-input-fullwidth",rows:"1",disabled:c}),s.jsx("button",{onClick:()=>me(),disabled:!l.trim()&&!A||c||!_||I||J,className:`send-btn-fullwidth ${_?"":"offline"} ${c||I||J?"loading":""}`,title:_?I?"Recording in progress":J?"Processing voice message":c?"Sending...":"Send message":"No internet connection",children:s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),s.jsx("polygon",{points:"22,2 15,22 11,13 2,9"})]})})]})]})]}),f&&s.jsx("div",{className:"menu-overlay",onClick:()=>b(!1),children:s.jsxs("div",{className:"conversations-menu",onClick:y=>y.stopPropagation(),children:[s.jsxs("div",{className:"menu-header",children:[s.jsx("h3",{children:"ðŸ’¬ Your Conversations"}),s.jsx("button",{className:"menu-close",onClick:()=>b(!1),children:"Ã—"})]}),s.jsx("div",{className:"menu-actions",children:s.jsx("button",{className:"new-chat-btn",onClick:fe,children:"âž• Start New Chat"})}),s.jsxs("div",{className:"conversations-list",children:[x.length===0&&s.jsx("p",{className:"no-conversations",children:"No previous conversations found. Start chatting to create your first conversation!"}),x.map(y=>s.jsxs("div",{className:"conversation-item",onClick:()=>_e(y.id),children:[s.jsxs("div",{className:"conv-preview",children:[s.jsx("span",{className:"conv-date",children:new Date(y.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:new Date(y.created_at).getFullYear()!==new Date().getFullYear()?"numeric":void 0})}),s.jsx("span",{className:"conv-time",children:new Date(y.last_message_at||y.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),s.jsx("div",{className:"conv-snippet",children:y.summary||y.last_message||`Conversation started ${new Date(y.created_at).toLocaleDateString()}`}),s.jsxs("div",{className:"conv-message-count",children:[y.message_count||0," messages"]})]},y.id))]})]})}),s.jsx("div",{className:"chat-footer",children:s.jsxs("p",{className:"disclaimer",children:[s.jsx("strong",{children:"Disclaimer:"})," MOMi is an AI assistant and does not provide medical advice. Always consult with healthcare professionals for medical concerns."]})})]})}catch(a){return console.error("ChatPage render error:",a),s.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[s.jsx("h2",{children:"Chat Loading Error"}),s.jsx("p",{children:"There was an error loading the chat interface."}),s.jsxs("p",{children:["Error: ",a.message]}),s.jsx("button",{onClick:()=>window.location.reload(),children:"Reload Page"})]})}},mo=()=>s.jsx("div",{className:"terms-page",children:s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"terms-header",children:[s.jsx("img",{src:"/momi-icon-2.png",alt:"MOMS on a Mission Logo",className:"terms-logo"}),s.jsx("h1",{children:"Terms of Service & Privacy Policy"}),s.jsx("p",{className:"terms-subtitle",children:"MOMi AI Chatbot"})]}),s.jsxs("div",{className:"terms-content",children:[s.jsxs("div",{className:"terms-section",children:[s.jsx("h2",{children:"Terms of Service"}),s.jsxs("p",{className:"effective-date",children:[s.jsx("strong",{children:"Effective Date:"})," September 8, 2025"]}),s.jsxs("p",{className:"contact-info",children:[s.jsx("strong",{children:"Contact Email:"})," admin@7pillarsmission.com"]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"1. Acceptance of Terms"}),s.jsx("p",{children:"By accessing or using MOMi (the Moms on a Mission Intelligent Assistant), you agree to these Terms of Service. If you do not agree, please discontinue use of MOMi immediately."})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"2. Purpose of MOMi"}),s.jsx("p",{children:"MOMi is an AI-powered health and wellness coach designed to provide general educational content, encouragement, and lifestyle support for moms and families. MOMi does not provide medical advice, diagnosis, or treatment. MOMi is not a substitute for professional medical care. Always consult with a licensed healthcare provider for medical concerns."})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"3. User Eligibility"}),s.jsx("p",{children:"You must be at least 18 years old to use MOMi. By using MOMi, you represent that you are legally able to enter into these Terms."})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"4. Privacy and Data"}),s.jsx("p",{children:"MOMi may collect information you provide during conversations to personalize your experience. We respect your privacy and do not sell personal information. For details, please see our Privacy Policy below."}),s.jsxs("ul",{children:[s.jsx("li",{children:"MOMi is not HIPAA-compliant and should not be used to store or transmit protected health information (PHI)."}),s.jsx("li",{children:"Do not share sensitive personal information such as social security numbers, financial data, or medical record numbers."})]})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"5. Community Guidelines"}),s.jsx("p",{children:"When using MOMi and participating in the MOMS on a Mission community:"}),s.jsxs("ul",{children:[s.jsx("li",{children:"Engage with kindness, respect, and authenticity."}),s.jsx("li",{children:"Do not use MOMi for unlawful, harmful, or abusive purposes."}),s.jsx("li",{children:"Do not attempt to misuse, copy, or reverse-engineer the MOMi platform."})]})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"6. Disclaimer of Warranties"}),s.jsx("p",{children:`MOMi is provided "as is" and "as available." We do not guarantee uninterrupted access, accuracy, or reliability of responses. MOMi's information should be considered supportive guidance, not professional advice.`})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"7. Limitation of Liability"}),s.jsx("p",{children:"To the fullest extent permitted by law:"}),s.jsxs("ul",{children:[s.jsx("li",{children:"MOMS on a Mission, its team members, and affiliates are not liable for any damages resulting from the use or inability to use MOMi."}),s.jsx("li",{children:"You agree that any reliance on MOMi's content is at your own risk."})]})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"8. Modifications"}),s.jsx("p",{children:"We may update these Terms of Service at any time. Updated terms will be posted here with a revised effective date. Your continued use of MOMi after changes indicates acceptance."})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"9. Termination"}),s.jsx("p",{children:"We reserve the right to suspend or terminate access to MOMi at our discretion, without notice, if you violate these Terms or misuse the service."})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"10. Governing Law"}),s.jsx("p",{children:"These Terms are governed by the laws of the State of North Carolina, without regard to conflict of law principles."})]}),s.jsxs("div",{className:"contact-section",children:[s.jsx("h3",{children:"Questions?"}),s.jsxs("p",{children:["Please contact us at ",s.jsx("a",{href:"mailto:admin@7pillarsmission.com",children:"admin@7pillarsmission.com"}),"."]})]})]}),s.jsxs("div",{className:"terms-section",children:[s.jsx("h2",{children:"Privacy Policy"}),s.jsxs("p",{className:"effective-date",children:[s.jsx("strong",{children:"Effective Date:"})," September 8, 2025"]}),s.jsxs("p",{className:"contact-info",children:[s.jsx("strong",{children:"Contact Email:"})," admin@7pillarsmission.com"]}),s.jsx("p",{children:"MOMi (Moms on a Mission Intelligent Assistant) is committed to respecting your privacy and protecting your personal information. This Privacy Policy explains how we collect, use, store, and protect your information when you use MOMi."}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"1. Purpose of Data Collection"}),s.jsx("p",{children:"Your information is used to customize your MOMi experience and improve the platform. This includes tailoring content, recommendations, and resources based on your preferences and goals."})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"2. How Your Data Is Used"}),s.jsx("p",{children:"Your information may be used:"}),s.jsxs("ul",{children:[s.jsx("li",{children:"By MOMS on a Mission team members to improve MOMi's accuracy, outputs, and overall community experience."}),s.jsx("li",{children:"By vetted, contracted employees to enhance technology, tools, and features."}),s.jsx("li",{children:"For aggregated, anonymized insights that help us refine our offerings."})]}),s.jsx("p",{children:s.jsx("strong",{children:"We never sell or share your personal information for marketing or profit outside of these purposes."})})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"3. Data Storage & Security"}),s.jsxs("ul",{children:[s.jsx("li",{children:"Information is stored on secure, encrypted servers."}),s.jsx("li",{children:"Access is restricted to authorized personnel and contractors under confidentiality agreements."}),s.jsx("li",{children:"We conduct annual security audits and additional reviews as needed to ensure compliance and protection."})]})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"4. Retention Policy"}),s.jsxs("ul",{children:[s.jsx("li",{children:"Your data is retained while your account is active."}),s.jsx("li",{children:"Data is deleted or anonymized within 6 months of account closure or prolonged inactivity."}),s.jsx("li",{children:"Aggregated, anonymized data may be retained indefinitely to help improve MOMi."})]})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"5. Your Rights"}),s.jsx("p",{children:"You have the right to:"}),s.jsxs("ul",{children:[s.jsx("li",{children:"Request a copy of your data by emailing admin@7pillarsmission.com."}),s.jsx("li",{children:"Request deletion of your data at any time by emailing admin@7pillarsmission.com."})]})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"6. Voluntary Participation"}),s.jsx("p",{children:"Participation in MOMi is voluntary. You may withdraw at any time without penalty. If you choose to withdraw, your personal data will be deleted or anonymized in accordance with our retention policy."})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"7. Limitations of AI Guidance"}),s.jsx("p",{children:"MOMi provides educational and coaching support only. MOMi is not a medical provider and does not offer medical advice, diagnosis, or treatment. Always consult a licensed healthcare professional for any medical concerns."})]}),s.jsxs("div",{className:"term-item",children:[s.jsx("h3",{children:"8. Consent"}),s.jsx("p",{children:"By using MOMi, you acknowledge and consent to the collection and use of your data as described in this Privacy Policy."})]}),s.jsxs("div",{className:"contact-section",children:[s.jsx("h3",{children:"Questions?"}),s.jsxs("p",{children:["For privacy-related questions, please contact: ",s.jsx("a",{href:"mailto:admin@7pillarsmission.com",children:"admin@7pillarsmission.com"})]})]})]})]}),s.jsx("div",{className:"terms-footer",children:s.jsx(Bt,{to:"/",className:"btn btn-primary",children:"Back to MOMi"})})]})}),fo=()=>{const[e,t]=w.useState(""),[r,n]=w.useState(""),[o,a]=w.useState(!1);ft();const i=async l=>{l.preventDefault(),a(!0),await z.auth.signOut();const{error:m}=await z.auth.signInWithPassword({email:e,password:r});m?g.error(m.message):(g.success("Logged in successfully!"),window.location.href="/chat"),a(!1)};return s.jsx("div",{className:"auth-page",children:s.jsxs("div",{className:"auth-container",children:[s.jsxs("div",{className:"auth-card",children:[s.jsx("img",{src:"/momi-icon-2.png",alt:"MOMS on a Mission Logo",className:"auth-logo"}),s.jsx("h1",{className:"auth-title",children:"Welcome Back to MOMi"}),s.jsx("p",{className:"auth-subtitle",children:"Your AI-powered wellness assistant is ready to continue supporting your journey."}),s.jsxs("form",{onSubmit:i,className:"auth-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"email",children:"Email Address"}),s.jsx("input",{type:"email",id:"email",value:e,onChange:l=>t(l.target.value),placeholder:"you@example.com",required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"password",children:"Password"}),s.jsx("input",{type:"password",id:"password",value:r,onChange:l=>n(l.target.value),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0})]}),s.jsx("button",{type:"submit",disabled:o,className:"btn btn-primary btn-large",style:{width:"100%"},children:o?"Signing in...":"Sign In"})]}),s.jsx("div",{className:"auth-footer",children:s.jsxs("p",{children:["No account yet? ",s.jsx(Bt,{to:"/register",children:"Create one here"})]})})]}),s.jsxs("div",{className:"landing-footer",children:[s.jsx("a",{href:"/terms",children:"Terms & Conditions"}),s.jsx("span",{children:"â€¢"}),s.jsx("a",{href:"https://7pillarsmission.com",target:"_blank",rel:"noopener noreferrer",children:"MOMS on a Mission"})]})]})})};function ho(){const[e,t]=w.useState(null),[r,n]=w.useState(null),[o,a]=w.useState(!1);w.useEffect(()=>{(async()=>{try{const c=await Rs();console.log("Initial user check:",(c==null?void 0:c.email)||"No user"),c&&(t(c),i(c))}catch(c){console.error("Error checking user session:",c)}})();const{data:{subscription:u}}=z.auth.onAuthStateChange(async(c,h)=>{var v;console.log("Auth state changed:",c,((v=h==null?void 0:h.user)==null?void 0:v.email)||"No user"),c==="SIGNED_IN"&&(h!=null&&h.user)?(t(h.user),i(h.user)):c==="SIGNED_OUT"&&(t(null),n(null))});return()=>{u==null||u.unsubscribe()}},[]);const i=async m=>{var u,c,h,v,j,f;a(!1);try{console.log("Loading profile for user:",m.id);const b=await Ps(m.id);if(b)console.log("Profile loaded successfully:",b.first_name),n(b),a(!0);else{console.log("No profile found, creating minimal fallback");const x={auth_user_id:m.id,email:m.email,first_name:((u=m.user_metadata)==null?void 0:u.first_name)||((c=m.email)==null?void 0:c.split("@")[0])||"User",last_name:((h=m.user_metadata)==null?void 0:h.last_name)||"",family_roles:[],children_count:0,main_concerns:[],dietary_preferences:[],personalized_support:!1};n(x),a(!0)}}catch(b){console.error("Error loading user profile:",b);const x={auth_user_id:m.id,email:m.email,first_name:((v=m.user_metadata)==null?void 0:v.first_name)||((j=m.email)==null?void 0:j.split("@")[0])||"User",last_name:((f=m.user_metadata)==null?void 0:f.last_name)||"",family_roles:[],children_count:0,main_concerns:[],dietary_preferences:[],personalized_support:!1};n(x),a(!0)}},l=(m,u)=>{t(m),n(u),a(!0)};return s.jsx(Pr,{children:s.jsxs("div",{className:"app",children:[s.jsx(Ss,{position:"top-right",toastOptions:{duration:4e3,style:{background:"white",color:"#333",border:"1px solid #EBC7F2",borderRadius:"8px"},success:{iconTheme:{primary:"#913D9A",secondary:"white"}},error:{iconTheme:{primary:"#EF4444",secondary:"white"}}}}),s.jsxs(_r,{children:[s.jsx(xe,{path:"/",element:e?s.jsx(Me,{to:"/chat",replace:!0}):s.jsx(fo,{})}),s.jsx(xe,{path:"/register",element:e?s.jsx(Me,{to:"/chat",replace:!0}):s.jsx(Cs,{onRegistrationSuccess:l})}),s.jsx(xe,{path:"/login",element:e?s.jsx(Me,{to:"/chat",replace:!0}):s.jsx(As,{onLoginSuccess:l})}),s.jsx(xe,{path:"/terms",element:s.jsx(mo,{})}),s.jsx(xe,{path:"/chat",element:e&&o?s.jsx(uo,{user:e,userProfile:r}):e&&!o?s.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",background:"#f8fafc"},children:s.jsxs("div",{style:{textAlign:"center",animation:"fadeIn 0.3s ease-in"},children:[s.jsx("div",{style:{fontSize:"32px",marginBottom:"12px",animation:"pulse 1s infinite"},children:"ðŸ¤–"}),s.jsx("div",{style:{color:"#64748b",fontSize:"16px",fontWeight:"500"},children:"Personalizing your experience..."})]})}):s.jsx(Me,{to:"/login",replace:!0})}),s.jsx(xe,{path:"*",element:s.jsx("div",{className:"not-found",children:s.jsxs("div",{className:"container",children:[s.jsx("h1",{children:"Page Not Found"}),s.jsx("p",{children:"The page you're looking for doesn't exist."}),s.jsx("a",{href:"/",className:"btn btn-primary",children:"Go Home"})]})})})]})]})})}ot.createRoot(document.getElementById("root")).render(s.jsx(nt.StrictMode,{children:s.jsx(ho,{})}));
